# GROMACS-cgenff

**Full Description**


It is assumed that some users, myself included, have faced issues with the CGENFF-CHARMM2GMX scripts when generating the essential .itp and .prm files for molecular dynamics in GROMACS, so a personal solution that proved effective is provided here.

This script converts topology and parameter files generated by the CHARMM General Force Field (CGenFF) into GROMACS-compatible formats. It includes compatibility patches for modern Python and NetworkX versions and addresses regular expression warnings.

Key Fixes and Features**
**Key Fixes and Features**

1. **NetworkX API Update**

   * Replaced all deprecated `self.G.node[...]` calls with `self.G.nodes[...]` to support NetworkX 2.4 and later.

2. **Robust `gcd` Import**

   * Wrapped the `gcd` import in a `try/except` block to import from `fractions` for Python ≤ 3.8 or fallback to `math` on Python 3.9+:

     ```python
     try:
         from fractions import gcd
     except ImportError:
         from math import gcd
     ```

3. **Regular Expression Correction**

   * Updated `re.split('\s+', ...)` to raw-string `re.split(r'\s+', ...)` to eliminate `SyntaxWarning`.

4. **Version Parsing**

   * Added `from packaging import version` and uses `version.parse(...)` to compare CGenFF and force field versions.

---

## Installation Guide

### Prerequisites

* **Conda** (Miniconda or Anaconda) recommended
* Python 3.7–3.8
* Access to Conda-forge channel

### Step 1: Create and Activate Conda Environment

```bash
conda create -n cgenff_env python=3.8 networkx=2.3 numpy packaging -c conda-forge
conda activate cgenff_env
```

### Step 2: (Optional) Install via pip

If you prefer pip within the activated environment:

```bash
pip install numpy packaging networkx==2.3
```

---

## Usage

### Basic Command Syntax

```bash
python cgenff_charmm2gmx_py3_nx2_1_corrected.py <RESI_NAME> <MOL2_FILE> <STR_FILE> <FF_DIRECTORY>
```

* `<RESI_NAME>`: Residue name (must match exactly in both MOL2 and STR files).
* `<MOL2_FILE>`: CGenFF-generated `.cgenff.mol2` file.
* `<STR_FILE>`: CGenFF-generated `.str` stream file.
* `<FF_DIRECTORY>`: Path to the CHARMM force field folder (e.g., `charmm36-feb2021.ff/`).

### Example

```bash
python cgenff_charmm2gmx_py3_nx2_1_corrected.py UNK UNK_M.cgenff.mol2 UNK_M.str charmm36-feb2021.ff/
```

### Common Tips

* **Residue Name Mismatch:** If you encounter the "no. of atoms in mol2 (X) and top (0) are unequal" error, verify that `<RESI_NAME>` matches the residue block in both files (case-sensitive).
* **Version Warnings:** The script will warn if CGenFF versions differ between the `.str` file and `forcefield.doc`.

---

## Notes and Recommendations

* For maximum stability, use Python 3.7–3.8 with NetworkX 2.3.
* The provided Conda environment eliminates the need to patch code manually.
* If not using Conda, ensure `numpy`, `packaging`, and `networkx==2.3` are installed in your Python environment.

---

## License

Released under the MIT License.
